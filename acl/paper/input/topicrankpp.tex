\section{TopicRank++}
\label{sec:topicrankpp}
  This section presents TopicRank++, a supervised extension of TopicRank that
  adds AKA. Topic\-Rank works in three steps:
  \begin{enumerate}
    \item{Clustering candidate keyphrases that belongs to the same topic.
          \newcite{bougouin2013topicrank} assumes that candidate of the same
          topic must share as many words as possible. They uses a Hierarchical
          Agglomerative Clustering (HAC) with a ``naive'' stem overlap
          similarity: at the beginning, each candidate is a single cluster and
          candidates sharing an average of $\unitfrac{1}{4}$ stemmed words with
          the candidates of a given cluster are added to this cluster.}
    \item{Building a graph of topics and ranking the topics using
          TextRank~\cite{mihalcea2004textrank}. Each topic is connected to the
          other topics by edges weighted according to the semantic strength
          between the connected topics. TextRank ranking algorithm recursively
          gives high importance to topics strongly connected to as most
          important topics as possible.}
    \item{Extracting keyphrases among the candidates of the $N$ most important
          topics. To avoid topic redundancy, TopicRank only extracts one
          keyphrase per topic. Following previous
          observations~\cite{witten1999kea}, \newcite{bougouin2013topicrank}
          extract the first occurring candidate from each topic.}
  \end{enumerate}

  To fit our need, TopicRank++ has a different graph construction. We also
  replace the classic TextRank ranking algorithm by a co-ranking variant and
  we integrate AKA during the former AKE process.

  \subsection{Graph construction}
  \label{subsec:graph_construction}
    TopicRank++ operates over a unified graph that connects two graphs
    representing the domain's reference keyphrases, the document's topics and
    the relations between them. Formally, let $G = (V, E)$ denote the unified
    graph. Reference keyphrases and topics are vertices $V$, respectively $V_k$
    and $V_t$, connected to their equals by edges
    $E_\textnormal{\textit{intra}}$ and connected to the other vertices by edges
    $E_\textnormal{\textit{outer}}$ (see Figure~\ref{fig:topicrankpp_graph}).

    \begin{figure*}
      \newcommand{\xslant}{0.25}
      \newcommand{\yslant}{0}

      \centering
      \begin{tikzpicture}[transform shape, scale=.66]
        % frame
        \node [draw,
               rectangle,
               minimum width=.7\linewidth,
               minimum height=8em,
               xslant=\xslant,
               yslant=\yslant] (domain_graph) {};
        \node [above=of domain_graph,
               xshift=.36\linewidth,
               yshift=8em,
               anchor=south east] (domain_graph_label) {domain keyphrases};

        \node [draw,
               circle,
               above=of domain_graph,
               xshift=.3\linewidth,
             yshift=5em] (domain_node1) {$V_{k_1}$};
        \node [draw,
               circle,
               above=of domain_graph,
               xshift=-.3\linewidth,
               yshift=5em] (domain_node2) {$V_{k_2}$};
        \node [draw,
               circle,
               above=of domain_graph,
               yshift=5em] (domain_node3) {$V_{k_3}$};
        \node [draw,
               circle,
               above=of domain_graph,
               xshift=.15\linewidth,
               yshift=.75em] (domain_node4) {$V_{k_4}$};
        \node [draw,
               circle,
               above=of domain_graph,
               xshift=-.15\linewidth,
               yshift=.75em] (domain_node5) {$V_{k_5}$};

        \draw [<->] (domain_node1) -- (domain_node3);
        \draw [<->] (domain_node2) -- (domain_node3);
        \draw [<->] (domain_node2) -- (domain_node4);
        \draw [<->] (domain_node4) -- (domain_node5);
        \draw [<->] (domain_node4) -- (domain_node3);

        % document
        \node [draw,
               rectangle,
               minimum width=.7\linewidth,
               minimum height=8em,
               xslant=\xslant,
               yslant=\yslant,
               above=of domain_graph,
               xshift=-2em] (document_graph) {};
        \node [below=of document_graph,
               xshift=-.36\linewidth,
               yshift=-8em,
               anchor=north west] (document_graph_label) {document topics};

        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               xshift=.3\linewidth,
               yshift=-5em] (document_node1) {$V_{t_1}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               xshift=-.3\linewidth,
               yshift=-5em] (document_node2) {$V_{t_2}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
             yshift=-5em] (document_node3) {$V_{t_3}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               xshift=.15\linewidth,
               yshift=-.75em] (document_node4) {$V_{t_4}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               xshift=-.1\linewidth,
               yshift=-.75em] (document_node5) {$V_{t_5}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               yshift=-.75em] (document_node6) {$V_{t_6}$};
        \node [draw,
               regular polygon,
               regular polygon sides=8,
               below=of document_graph,
               xshift=-.175\linewidth,
               yshift=-5em] (document_node7) {$V_{t_7}$};

        \draw [<->] (document_node2) -- (document_node7);
        \draw [<->] (document_node2) -- (document_node5);
        \draw [<->] (document_node7) -- (document_node5);
        \draw [<->] (document_node7) -- (document_node3);
        \draw [<->] (document_node5) -- (document_node6);
        \draw [<->] (document_node3) -- (document_node1);
        \draw [<->] (document_node1) -- (document_node4);
        \draw [<->] (document_node3) -- (document_node4);

        % extra link
        \draw [<->, dashed] (document_node2) -- (domain_node2);
        \draw [<->, dashed] (document_node6) -- (domain_node5);
        \draw [<->, dashed] (document_node6) -- (domain_node3);
        \draw [<->, dashed] (document_node4) -- (domain_node1);
        \draw [<->, dashed] (document_node3) -- (domain_node4);

        % legend
        \node [right=of document_graph, xshift=2em, yshift=-9.25em] (legend_title) {\underline{Legend:}};
        \node [below=of legend_title, xshift=-1em, yshift=2em] (begin_inner) {};
        \node [right=of begin_inner] (end_inner) {: $E_\textnormal{\textit{inner}}$};
        \node [below=of begin_inner, yshift=1.5em] (begin_outer) {};
        \node [right=of begin_outer] (end_outer) {: $E_\textnormal{\textit{outer}}$};

        \draw (legend_title.north  -| end_outer.east) rectangle (end_outer.south -| legend_title.west);

        \draw [<->] (begin_inner) -- (end_inner);
        \draw [<->, dashed] (begin_outer) -- (end_outer);
      \end{tikzpicture}
      \caption{Example of a unified graph constructed by TopicRank++ and its two
               kinds of edges: inner- and outer-graph edges
               \label{fig:topicrankpp_graph}}
    \end{figure*}

    We create edges $E_\textnormal{\textit{intra}}$ between two reference
    keyphrases or two topics when they co-occur, respectively, as reference
    keyphrases for a document of the domain or within a sentence of the
    document. Each edge $E_{\textnormal{\textit{intra}}_{ij}}$ is weighted by
    the normalized number of co-occurrences $w_{ij}$ between the reference
    keyphrases $V_{k_i}$ and $V_{k_j}$ or the topics $V_{t_i}$ and $V_{t_j}$.

    To unify the two graphs, we look for reference keyphrase occurrences within
    the document. The domain keyphrases can be seen as a category map of the
    domain. We try to connect the document to its potential categories. An edge
    $E_{\textnormal{\textit{outer}}_{ij}}$ is created to connect a reference
    keyphrase $V_{k_i}$ and a topic $V_{t_j}$ if the reference keyphrase is a
    member of the topic, i.e.~a keyphrase candidate that belongs to the topic.
    To accept flexions, such as plural flexions, we perform the comparison with
    stems.

  \subsection{Graph-based co-ranking}
  \label{subsec:graph_based_co_ranking}
    This ranking leverages both the reference keyphrase relations and the topic
    relations. Based on TextRank's random walk~\cite{mihalcea2004textrank}, our
    co-ranking algorithm combines the recommendations within each graph in such
    a way that the random part is replaced by a recommendation comming from the
    other graph:
    \begin{tiny}
      \begin{align}
        S(V_{t_i}) &= (1 - \lambda) \sum_{E_{\text{outer}_{ji}}}{\frac{S(V_{k_j})}{\mathlarger\sum_{E_{\text{outer}_{jm}}}{1}}} + \lambda \sum_{E_{\text{inner}_{ij}}}{\frac{w_{ij} S(V_{t_j})}{\mathlarger\sum_{E_{\text{inner}_{jm}}}{{w_{jm}}}}}\\
        S(V_{k_i}) &= (1 - \lambda) \sum_{E_{\text{outer}_{ij}}}{\frac{S(V_{t_j})}{\mathlarger\sum_{E_{\text{outer}_{mj}}}{1}}} + \lambda \sum_{E_{\text{inner}_{ij}}}{\frac{w_{ij} S(V_{k_j})}{\mathlarger\sum_{E_{\text{inner}_{jm}}}{{w_{jm}}}}}
      \end{align}
    \end{tiny}
    These formula embed two assumptions:
    \begin{enumerate}
      \item{A reference keyphrase is important if it is strongly linked to other
            reference keyphrases and a topic is important if it is strongly
            linked to other topics.}
      \item{A reference keyphrase is more important in the context of the
            document if it is related to the topics within the document and a
            topic is more important if it relates to domain keyphrases.}
    \end{enumerate}
    The first assumption is the former TextRank assumption. The second is
    induced by the unification of both domain keyphrases and document topics.

    The $\lambda$ factor helps to configure the influence of the document topics
    over the whole ranking (in percentage). A higher $\lambda$ gives a higher
    influence to the document topics than a lower $\lambda$. $\lambda=0.5$
    balances the influence of the ranking of the document and of the domain.

  \subsection{Keyphrase assignment and extraction}
  \label{subsec:keyphrase_assignment_and_extraction}
    To both assign and extract keyphrases, we first sort the reference
    keyphrases and the document's topics using their importance score obtained
    with the co-ranking, then we retain the top $N$ ones.

    We assign reference keyphrases over one condition. A reference keyphrase can
    be assigned to a document if it is directly or transitively connected to a
    topic of the document. In other words, if the ranking of a reference
    keyphrase has not been influenced by the document, we do not consider this
    reference keyphrase.

    We extract keyphrases from the topics using the former TopicRank strategy.
    Only one keyphrase is extracted per topic. The extracted keyphrase is the
    candidate of the topic that occurs first within the document.

    This AKA and AKE can be further improved. One can set the ratio of
    keyphrases to assign and keyphrases to extract, or even control the degree
    of generalization of the assigned keyphrases. One may be interested in
    assigning very specific keyphrases regarding the document(\TODO{example}),
    whereas one may want to assign more general keyphrases (\TODO{example}). The
    minimum deph between a reference keyphrase and a document topic encodes this
    degree of generalization. A reference keyphrase directly connected to a
    document topic has the lowest generalization regarding the document,
    followed by its connected reference keyphrases, and so on.

